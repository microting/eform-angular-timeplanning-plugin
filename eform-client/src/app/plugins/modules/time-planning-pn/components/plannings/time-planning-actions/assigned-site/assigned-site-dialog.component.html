<div mat-dialog-title>{{ data.siteName }}</div>
<div mat-dialog-content>
  <!-- DEBUG: Dialog content started -->
  <div id="debug-dialog-content-start" style="display:none;">Dialog content rendering</div>
  <h3 style="background: yellow; padding: 10px; margin: 10px 0;">
    DEBUG: Dialog opened - Check tab visibility below
  </h3>
  <div style="background: lightgray; padding: 10px; margin: 10px 0; font-family: monospace;">
    <div>isAdmin = <span style="font-weight: bold; color: red;">{{isAdmin}}</span></div>
    <div>isFirstUser = <span style="font-weight: bold; color: red;">{{isFirstUser}}</span></div>
    <div>form = <span style="font-weight: bold; color: red;">{{assignedSiteForm ? 'EXISTS' : 'NULL'}}</span></div>
    <div>useOnlyPlanHours = <span style="font-weight: bold; color: red;">{{data.useOnlyPlanHours}}</span></div>
    <div>useGoogleSheetAsDefault = <span style="font-weight: bold; color: red;">{{data.useGoogleSheetAsDefault}}</span></div>
  </div>
  <mat-tab-group
    dynamicHeight="false"
  >
    <!-- DEBUG: Tab group started -->
    <div id="debug-tab-group-start" style="display:none;">Tab group rendering</div>
    <mat-tab label="{{'General' | translate }}" >
      <!-- DEBUG: General tab started -->
      <div id="debug-general-tab" style="background: lightblue; padding: 5px;">DEBUG: General Tab Content</div>
      <app-assigned-site-general-tab
        [data]="data"
        [assignedSiteForm]="assignedSiteForm"
        [isFirstUser]="isFirstUser"
        [isAdmin]="isAdmin">
      </app-assigned-site-general-tab>
    </mat-tab>
    <mat-tab label="{{'Plan hours' | translate }} "
             *ngIf="data.useOnlyPlanHours && !data.useGoogleSheetAsDefault && isFirstUser">
      <div formGroupName="planHours">
        <app-assigned-site-plan-hours-tab
          [planHoursForm]="getPlanHoursFormGroup()">
        </app-assigned-site-plan-hours-tab>
      </div>
    </mat-tab>
    <mat-tab  label="{{ 'Auto break calculation settings' | translate }}"
             *ngIf="data.autoBreakCalculationActive && isAdmin">
      <div [formGroupName]="'autoBreakSettings'">
        <app-assigned-site-auto-break-tab
          [autoBreakSettingsForm]="getAutoBreakSettingsFormGroup()"
          (autoBreakValueSet)="setAutoBreakValue($event.day, $event.control, $event.value)"
          (breakSettingsCopied)="copyBreakSettings($event)">
        </app-assigned-site-auto-break-tab>
      </div>
    </mat-tab>
    <mat-tab  label="{{'1st shift' | translate }}"
             *ngIf="!data.useOnlyPlanHours && !data.useGoogleSheetAsDefault && isFirstUser">
      <div [formGroupName]="'firstShift'">
        <app-assigned-site-shift-tab
          [shiftForm]="getFirstShiftFormGroup()"
          [data]="data"
          [shiftSuffix]="''"
          [isAdmin]="isAdmin"
          (minutesSet)="setMinutes($event.event, $event.field)">
        </app-assigned-site-shift-tab>
      </div>
    </mat-tab>
    <mat-tab  label="{{'2nd shift' | translate }}"
             *ngIf="!data.useOnlyPlanHours && !data.useGoogleSheetAsDefault && isFirstUser">
      <div [formGroupName]="'secondShift'">
        <app-assigned-site-shift-tab
          [shiftForm]="getSecondShiftFormGroup()"
          [data]="data"
          [shiftSuffix]="'2NdShift'"
          [isAdmin]="isAdmin"
          (minutesSet)="setMinutes($event.event, $event.field)">
        </app-assigned-site-shift-tab>
      </div>
    </mat-tab>
    <mat-tab label="{{'3rd shift' | translate }}"
             *ngIf="data.thirdShiftActive && !data.useOnlyPlanHours && !data.useGoogleSheetAsDefault && isFirstUser">
      <div [formGroupName]="'thirdShift'">
        <app-assigned-site-shift-tab
          [shiftForm]="getThirdShiftFormGroup()"
          [data]="data"
          [shiftSuffix]="'3RdShift'"
          [isAdmin]="isAdmin"
          (minutesSet)="setMinutes($event.event, $event.field)">
        </app-assigned-site-shift-tab>
      </div>
    </mat-tab>
    <mat-tab label="{{'4th shift' | translate }}"
             *ngIf="data.thirdShiftActive && data.fourthShiftActive && !data.useOnlyPlanHours && !data.useGoogleSheetAsDefault && isFirstUser">
      <div [formGroupName]="'fourthShift'">
        <app-assigned-site-shift-tab
          [shiftForm]="getFourthShiftFormGroup()"
          [data]="data"
          [shiftSuffix]="'4ThShift'"
          [isAdmin]="isAdmin"
          (minutesSet)="setMinutes($event.event, $event.field)">
        </app-assigned-site-shift-tab>
      </div>
    </mat-tab>
    <mat-tab label="{{'5th shift' | translate }}"
             *ngIf="data.thirdShiftActive && data.fourthShiftActive && data.fifthShiftActive && !data.useOnlyPlanHours && !data.useGoogleSheetAsDefault && isFirstUser">
      <div [formGroupName]="'fifthShift'">
        <app-assigned-site-shift-tab
          [shiftForm]="getFifthShiftFormGroup()"
          [data]="data"
          [shiftSuffix]="'5ThShift'"
          [isAdmin]="isAdmin"
          (minutesSet)="setMinutes($event.event, $event.field)">
        </app-assigned-site-shift-tab>
      </div>
    </mat-tab>
  </mat-tab-group>
</div>
<div mat-dialog-actions class="d-flex flex-row justify-content-end">
  <button
    class="btn-cancel"
          mat-dialog-close
          id="cancelButton">
    {{ 'Cancel' | translate }}
  </button>
  <button
    class="btn-primary btn-primary--icon-left"
    id="saveButton"
    (click)="updateAssignedSite()"
    [mat-dialog-close]="data">
    <span>{{ 'Save' | translate }}</span>
  </button>
</div>
